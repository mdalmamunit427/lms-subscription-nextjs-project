[
  {
    "id": "TC001",
    "title": "Clerk Webhook User Creation Sync",
    "description": "Verify that the Clerk webhook successfully syncs new user data to MongoDB upon a 'user.created' event with valid webhook signature.",
    "category": "integration",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send a 'user.created' webhook event from Clerk with valid svix headers and payload containing new user details."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 200 response confirming webhook received successfully."
      },
      {
        "type": "assertion",
        "description": "Check MongoDB user collection for a new user record with matching clerkId, email, firstName, lastName, and imageUrl."
      },
      {
        "type": "assertion",
        "description": "Verify that createdAt and updatedAt timestamps are correctly set."
      }
    ]
  },
  {
    "id": "TC002",
    "title": "Clerk Webhook User Update Sync",
    "description": "Verify that the Clerk webhook updates existing user data in MongoDB upon a 'user.updated' event with valid webhook signature.",
    "category": "integration",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Ensure an existing user record in MongoDB for a given clerkId."
      },
      {
        "type": "action",
        "description": "Send a 'user.updated' webhook event from Clerk with modified user data and valid svix headers."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 200 response confirming webhook received successfully."
      },
      {
        "type": "assertion",
        "description": "Check MongoDB user record is updated with changed email, firstName, lastName, and imageUrl fields."
      },
      {
        "type": "assertion",
        "description": "Verify updatedAt timestamp is updated while createdAt remains unchanged."
      }
    ]
  },
  {
    "id": "TC003",
    "title": "Clerk Webhook Signature Validation Failure",
    "description": "Verify the Clerk webhook endpoint rejects requests with missing or invalid svix signature headers.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send a webhook request to the Clerk webhook endpoint with missing svix-id header."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 400 response with appropriate error message indicating missing svix headers."
      },
      {
        "type": "action",
        "description": "Send a webhook request with invalid svix-signature and valid timestamp and svix-id."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 400 response indicating invalid webhook signature."
      }
    ]
  },
  {
    "id": "TC004",
    "title": "Sign In Page Rendering and Redirect",
    "description": "Verify that the Sign In page renders the Clerk SignIn component correctly and handles optional redirect_url query parameter.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Navigate to /sign-in without query parameters."
      },
      {
        "type": "assertion",
        "description": "Verify the Clerk SignIn component is rendered with custom styling."
      },
      {
        "type": "action",
        "description": "Navigate to /sign-in with a valid redirect_url query parameter."
      },
      {
        "type": "assertion",
        "description": "Verify that after successful sign-in, user is redirected to the specified redirect_url."
      },
      {
        "type": "action",
        "description": "Perform sign-in with valid user credentials."
      },
      {
        "type": "assertion",
        "description": "Verify user authentication success and redirection."
      }
    ]
  },
  {
    "id": "TC005",
    "title": "Sign Up Page Rendering and Redirect",
    "description": "Verify that the Sign Up page renders the Clerk SignUp component correctly and handles optional redirect_url query parameter.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Navigate to /sign-up without query parameters."
      },
      {
        "type": "assertion",
        "description": "Verify the Clerk SignUp component is rendered with custom styling."
      },
      {
        "type": "action",
        "description": "Navigate to /sign-up with a valid redirect_url query parameter."
      },
      {
        "type": "assertion",
        "description": "Verify that after successful sign-up, user is redirected to the specified redirect_url."
      },
      {
        "type": "action",
        "description": "Perform sign-up with valid new user details."
      },
      {
        "type": "assertion",
        "description": "Verify user account creation success and redirection."
      }
    ]
  },
  {
    "id": "TC006",
    "title": "Subscription Purchase Flow with Stripe",
    "description": "Verify the end-to-end subscription purchase flow where a user completes payment through Stripe checkout and subscription is activated via webhook.",
    "category": "integration",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Login as a user without an active subscription."
      },
      {
        "type": "action",
        "description": "Start Stripe checkout flow for the $99 subscription product."
      },
      {
        "type": "action",
        "description": "Complete payment successfully via Stripe checkout."
      },
      {
        "type": "action",
        "description": "Simulate Stripe webhook event with valid signature indicating successful subscription activation."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 200 response from Stripe webhook endpoint."
      },
      {
        "type": "assertion",
        "description": "Verify user's subscription status and expiration date are updated correctly in MongoDB."
      },
      {
        "type": "action",
        "description": "Access user dashboard."
      },
      {
        "type": "assertion",
        "description": "Verify dashboard shows active subscription status and access to premium courses."
      }
    ]
  },
  {
    "id": "TC007",
    "title": "Stripe Webhook Signature Validation",
    "description": "Verify that the Stripe webhook endpoint rejects events with missing or invalid signature headers.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send a webhook request to Stripe webhook handler with missing signature header."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 400 response indicating missing or invalid webhook header."
      },
      {
        "type": "action",
        "description": "Send a webhook request to Stripe webhook handler with invalid signature."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 400 response indicating invalid webhook signature."
      }
    ]
  },
  {
    "id": "TC008",
    "title": "Access Control Enforcement for Premium Content",
    "description": "Verify that only subscribed users can access premium course content and others are redirected appropriately.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Attempt to access premium course content page as a non-subscribed user."
      },
      {
        "type": "assertion",
        "description": "Verify redirection to pricing page."
      },
      {
        "type": "action",
        "description": "Access premium course content as a subscribed user."
      },
      {
        "type": "assertion",
        "description": "Verify premium course content is displayed."
      }
    ]
  },
  {
    "id": "TC009",
    "title": "Admin Dashboard Access Restriction",
    "description": "Verify that only users with admin role can access admin dashboard and perform course management actions.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Login as a non-admin user and attempt to access admin dashboard routes."
      },
      {
        "type": "assertion",
        "description": "Verify access is denied or redirected appropriately."
      },
      {
        "type": "action",
        "description": "Login as an admin user and access the admin dashboard."
      },
      {
        "type": "assertion",
        "description": "Verify successful access to admin dashboard."
      },
      {
        "type": "action",
        "description": "Perform course Create, Read, Update, and Delete operations via admin dashboard."
      },
      {
        "type": "assertion",
        "description": "Verify all CRUD operations succeed and changes are reflected in course listings."
      }
    ]
  },
  {
    "id": "TC010",
    "title": "User Model Duplicate Prevention on Webhook",
    "description": "Verify that Clerk webhook handler does not create duplicate user records when receiving multiple identical events.",
    "category": "error handling",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Send multiple identical 'user.created' webhook events for the same clerkId."
      },
      {
        "type": "assertion",
        "description": "Verify only a single user record exists in MongoDB for the clerkId."
      }
    ]
  },
  {
    "id": "TC011",
    "title": "Frontend Error Handling for Webhook Failures",
    "description": "Verify system handles cases when webhook secret is missing or database sync fails gracefully with proper error responses.",
    "category": "error handling",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Simulate Clerk webhook call without webhook secret configured."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 500 response with error indicating missing webhook secret."
      },
      {
        "type": "action",
        "description": "Simulate webhook with invalid user data causing database update failure."
      },
      {
        "type": "assertion",
        "description": "Verify HTTP 500 response indicating error syncing user to database."
      }
    ]
  }
]
